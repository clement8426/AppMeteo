<div class="container-fluid" style="height: 100vh">
    <form class="form-inline d-flex mt-4 w-50">
        <input class="form-control mr-sm-4 text-center" type="search" placeholder="Ville/pays" aria-label="Search">
        <button class="btn btn-secondary" type="submit" style="margin-right: 12px;">Chercher</button>
    </form>
    <div class="row mt-3">
        <div class="col-md-6">
            <div class="card"  style="background-color: grey">
                <div class="card-body">
                    <div id="flag"></div>
                    <div id="weather-info"></div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card" style="background-color: grey">
<div class="card-body full-width-list">
                    <h1 class="text-center">Recent checks (10)</h1>
                    <div class="d-flex justify-content-between mb-2">
                        <div><strong>Location</strong></div>
                        <div><strong>Temperature</strong></div>
                        <div><strong>Weather</strong></div>
                        <div><strong>Day/Night</strong></div>
                        <div><strong>Date</strong></div>
                    </div>
                    <ul style="padding-left: 0; list-style-type: none;">
                      <% Visitor.order(created_at: :desc).limit(10).each do |visitor| %>
                      <%= turbo_frame_tag "visitor#{visitor.id}" do %>
                          <%= render 'shared/visitor', visitor: visitor %>
                        <% end %>
                      <% end %>
                    </ul>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Update timer every second for each visitor
    setInterval(updateTimers, 1000);
  });

function updateTimers() {
  var visitors = document.querySelectorAll("[id^=timer_]");
  visitors.forEach(function(visitor) {
    var createdTime = new Date(visitor.getAttribute('data-created-at'));
    var currentTime = new Date();
    var elapsedTimeInSeconds = Math.floor((currentTime - createdTime) / 1000);
    visitor.innerText = formatTime(elapsedTimeInSeconds);
  });
}

function formatTime(seconds) {
  if (seconds < 60) {
    return seconds + " sec";
  } else {
    var minutes = Math.floor(seconds / 60);
    return minutes + " min";
  }
}

  function pad(number) {
    return (number < 10 ? "0" : "") + number;
  }
</script>
